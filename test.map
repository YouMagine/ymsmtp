{"version":3,"sources":["test.coffee"],"names":[],"mappings":"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","file":"test.js","sourceRoot":"","sourcesContent":["class YmSmtpTest\n\tconstructor:->\n\t\t@debuglevel=10\n\t\t@name='Youmagine SMTP - test  suite'\n\t\trequire 'colors'\n\t\t@debug 1,\"Starting #{@name} \"\n\t\t@debug 1,\"Running some basic tests agains localhost:25\"\n\t\t@testNet()\n\n\ttestNet:()=>\n\t\tnet = require('net')\n\t\tHOST = '127.0.0.1'\n\t\tPORT = 25\n\t\tstep = 1\n\t\tok = true\n\t\tclient = new net.Socket()\n\t\tclient.on 'error', (err)=>\n\t\t\t@err 'Test new Failed: '+err.toString()\n\t\t\tprocess.exit 1\n\t\tclient.connect PORT, HOST, (data...)=>\n\t\t\t@debug 1,'Connected',data\n\t\tclient.on 'close',=>\n\t\t\tif ok\n\t\t\t\t@debug 1,'Connection closed'\n\t\t\telse\n\t\t\t\t@err 'Connection closed, but tests failed'\n\t\tclient.on 'data', (data)=>\n\t\t\t@debug 1,'Received',data.toString().trim()\n\t\t\tswitch step\n\t\t\t\twhen 1\n\t\t\t\t\tif data.toString().match /220.*ESMTP.*Haraka.*ready/\n\t\t\t\t\t\tstep=2\n\t\t\t\t\t\t@debug 1,'OK'\n\t\t\t\t\t\tclient.write(\"quit\\n\");\n\t\t\t\t\telse\n\t\t\t\t\t\t@err \"Failed to get proper server response\"\n\t\t\t\twhen 2\n\t\t\t\t\tif data.toString().match /221.*closing/\n\t\t\t\t\t\tstep=3\n\t\t\t\t\t\t@debug 1,\"Making connection succeeded\"\n\t\t\t\t\telse\n\t\t\t\t\t\t@err \"Failed to properly close connection to server\"\n\t\t\t\n\n\n\n\tdebug:(level,data...)=>\n\t\tif level<=@debuglevel\n\t\t\tconsole.error 'YmSmtpTest'.green,data...\n\n\terr:(data...)=>\n\t\tif @debuglevel>0\n\t\t\tconsole.error 'YmSmtpTest'.red.bgWhite,data...\n\nnew YmSmtpTest()\n"]}